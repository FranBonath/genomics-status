{% extends "base.html" %}

{% block stuff %}
<div class="container-xxl">
  <div class="col-10 mb-5 mx-auto text-center">
    <h1 class="mt-4 display-1">Genomics Status</h1>
    <p class="lead">Genomics status displays information on sequencing projects at the Stockholm node of National Genomics Infrastructure. <span id="updated-status"></span></p>

    {% if not user %}

    <h2> Get Access </h2>
    <p>To get access to the resources on this site, you first need to log in with the account given to you by your manager.</p>
    <p><a class="btn btn-primary btn-lg", href="/login">Log in</a></p>

    {% else %}
    <div class="mb-4 mt-3">
      <a type="button" class="btn btn-primary btn-lg px-4 mr-3" href="/projects">Projects</a>
      <a type="button" class="btn btn-primary btn-lg px-4 mr-3" href="/flowcells">Flowcells</a>
      <a type="button" class="btn btn-primary btn-lg px-4 mr-3" href="/worksets">Worksets</a>
      <a type="button" class="btn btn-primary btn-lg px-4" href="/deliveries">Deliveries</a>
    </div>
    <div class="alert alert-info">
      <p class="mb-0" style="text-align:center;">Want to see something different here? Let us know on the
        <a class="text-decoration-none" href="/suggestion_box">suggestions page</a>!
      </p>
    </div>

  </div>

  <div class="row pt-5">
    <div class="col-lg-8">
      <h3>Longest waiting projects</h3>
      <div class="scroll-body">
        <table class="table table-bordered sortable" id="prio_projs_table">
          <thead id="prio_projs_table_head">
            <tr class="sticky darkth">
              <th class="sort">Project:</th>
              <th class="sort">Library:</th>
              <th class="sort">Status:</th>
              <th class="sort">Days waiting:</th>
            </tr>
          </thead>
          <tbody id="prio_projs_table_body"></tbody>
        </table>
      </div>
    </div>

    <div class="col-lg-4">
      <h3>Server Status</h3>
      <table class="table table-bordered table-disk-quotas">
        <thead>
          <tr class="darkth">
            <th>Server</th>
            <th>Instrument</th>
            <th>Disk (Used / Quota)</th>
          </tr>
        </thead>
        <tbody>
          {% for server, status in server_status %}
          <tr>
            <td>{{ server }}</td>
            <td>{{ status.get('instrument') }}</td>
            <td class="disk-quotas-highcharts {{ status.get('css_class') }}"><div class="wrapper"><span class="val" style="width:{{ status.get('used_percentage') }};">
              <span>{{ status.get('space_used') }}</span></span>
              <span class="percent float-right">{{ status.get('disk_size') }}</span></div>
            </td>
          </tr>
          {% end %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script type="text/javascript" src="/static/js/index.js?v={{ gs_globals['git_commit'] }}" id="indexpage-js-import"></script>
<script src="/static/js/jquery.dataTables.min.js"></script>

{% end %}

{% end %}
