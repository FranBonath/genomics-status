{% extends "base.html" %}
<!--
Template file: barcode.html
URL: /barcode/
Title: Label and Barcode printing NGI
Description: Printing of Labels and Barcodes on the Main Lab barcode printer Zebra
-->

{% block stuff %}
<h1><span id="page_title">NGI Plate Label and Barcode Printing</span></h1>
<br>
<h3><span>Label and barcode printing for workset plates or internal use</span></h3>
<p>Here you can print plate labels and barcodes on the label printer "Zebra". Either enter
a text in the text field or upload a file.<p>
<p>Valid files are barcode files generated by LIMS or text files. In text files,
  each line will be printed on a separate label.<p>
<br>
<div id="query">
  <form class="form-horizontal" enctype="multipart/form-data" role="form" id="barcode_from_file" method="post" action="/barcode" onsubmit="return submit_form()">
    <div class="pull-left" style="margin-right:5px">
      <input id="print_label_file" type="file" name="file_to_print" class="btn btn-default" />
    </div>
    <br>
    <br>
    <br>
    <div class="pull-left" style="margin-right:5px">
      <input id="print_label_string" size="37" type="text" name="text_to_print" class="btn btn-default" placeholder="your text here" />
    </div>
    <br>
    <br>
    <br>
    <div class="pull-left" style="margin-right:5px">
      <td style="font-size:20px;"><strong>&nbsp;&nbsp;&nbsp; copies: &nbsp;</strong></td>
      <input id="label_copies" type="number" min="1" max="20" name="copies" class="btn btn-default" value="1" />
    </div>
    <button type="submit" class="btn btn-primary btn-lg" data-script="barcode">Print</button>
<!--  </form> -->
</div>
<br>
<hr>
<h3><span>User Project Barcode Printing</span></h3>
<div id="query">
<!--  <form class="form-horizontal" enctype="multipart/form-data" role="form" id="project_barcode_from_text" method="post" action="/barcode" onsubmit="return submit_form()"> -->
    <div class="pull-left" style="margin-right:5px">
      <input id="print_projectlabel" size="37" type="text" name="projectLabel_to_print" class="btn btn-default" placeholder="enter Project ID (i.e. P12345)" />
      <td style="font-size:20px;"><strong>&nbsp;&nbsp;&nbsp; start no. plate P_: &nbsp;</strong></td>
      <input id="project_Pstart" type="number" min="1" max="20" name="plate_start" class="btn btn-default" value="1" />
      <td style="font-size:20px;"><strong>&nbsp;&nbsp;&nbsp; end no. plate P_: &nbsp;</strong></td>
      <input id="project_Pend" type="number" min="1" max="20" name="plate_end" class="btn btn-default" value="5" />
      <td style="font-size:20px;"><strong>&nbsp;&nbsp;&nbsp; number of projects &nbsp;</strong></td>
      <input id="numberOfProjects" type="number" min="1" max="20" name="numberOfProjects" class="btn btn-default" value="1" />
    </div>
    <br>
    <br>
    <br>
    <div class="pull-left" style="margin-right:5px">
      <button type="submit" class="btn btn-primary btn-lg" data-script="barcode">Print Project Labels</button>
    </div>
    <br>
    <br>
  </form>

<script type="text/javascript">
  function submit_form() {
    if($.trim($('#print_label_file').val()).length == 0 && $.trim($('#print_label_string').val()).length == 0 && $.trim($('#print_projectlabel').val()).length == 0){
      alert('File, text and project label input fields cannot be empty at the same time!');
      return false;
    }
    $.ajax({
           type: "POST",
           url: $('#barcode_from_file').attr('action'),
           data: $('#barcode_from_file').serialize(), // serializes the form's elements.
           error: function(xhr, textStatus, errorThrown) {
             alert('Error: '+errorThrown);
             console.log(xhr); console.log(textStatus); console.log(errorThrown);
           },
           success: function(data, textStatus, xhr){
               alert(data['message']);
           }
         });
    return false; // avoid execution of the actual submit of the form.
}
</script>

{% end %}
