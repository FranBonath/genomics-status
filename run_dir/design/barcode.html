{% extends "base.html" %}
<!--
Template file: barcode.html
URL: /barcode/
Title: Label and Barcode printing NGI
Description: Printing of Labels and Barcodes on the Main Lab barcode printer Zebra
-->

{% block stuff %}
<h1><span id="page_title">NGI Plate Label and Barcode Printing</span></h1>
<p>Here you can print plate labels and barcodes on the label printer "Zebra". Either enter
a text in the text field or upload a file.<p>
<p>Valid files are barcode files generated by LIMS or text files. In text files,
  each line will be printed on a separate label.<p>
<br>
<div id="query">
  <form class="form-horizontal" enctype="multipart/form-data" role="form" id="barcode_from_file" method="post" action="/barcode" onsubmit="return submit_form()">
    <div class="pull-left" style="margin-right:5px">
      <input id="print_label_file" type="file" name="file_to_print" class="btn btn-default" />
    </div>
    <br>
    <br>
    <br>
    <div class="pull-left" style="margin-right:5px">
      <input id="print_label_string" size="37" type="text" name="text_to_print" class="btn btn-default" placeholder="your text here" />
    </div>
    <br>
    <br>
    <br>
    <div class="pull-left" style="margin-right:5px">
      <td style="font-size:20px;"><strong>&nbsp;&nbsp;&nbsp; copies: &nbsp;</strong></td>
      <input id="label_copies" type="number" min="1" max="20" name="copies" class="btn btn-default" value="1" />
    </div>
    <button type="submit" class="btn btn-primary btn-lg" data-script="barcode">Print</button>
  </form>
</div>

<script type="text/javascript">
  function submit_form() {
    if($.trim($('#print_label_file').val()).length == 0 && $.trim($('#print_label_string').val()).length == 0){
      alert('Both file and text input fields cannot be empty!');
      return false;
    }
    $.ajax({
           type: "POST",
           url: $('#barcode_from_file').attr('action'),
           data: $('#barcode_from_file').serialize(), // serializes the form's elements.
           error: function(xhr, textStatus, errorThrown) {
             alert('Error: '+errorThrown);
             console.log(xhr); console.log(textStatus); console.log(errorThrown);
           },
           success: function(data, textStatus, xhr){
               alert(data['message']);
           }
         });
    return false; // avoid execution of the actual submit of the form.
}
</script>

{% end %}
