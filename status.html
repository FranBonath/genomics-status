<html>
    <head>
        <title>Pika/Tornado Example</title>
        <link rel="icon" type="/image/vnd.microsoft.icon" 
        href="http://www.rabbitmq.com/favicon.ico" />
        <script type="text/javascript" src="static/jquery/dist/jquery.js"></script>
        <script type="text/javascript" src="static/d3/d3.js"></script> 
        
        <script type="text/javascript">
            $(document).ready(function(){

                var ws_uri = "ws://0.0.0.0:8888/websocket";
                ws = new WebSocket(ws_uri);

                ws.onmessage = function(e) {
                    console.log(e.data);
                    data.shift()
                    data.push(JSON.parse(e.data));
                    redraw();
                }
            });
        </script>

        <style type="text/css">
        html {
            font-family: Helvetica,Arial,Sans-Serif;
            font-size: 12px;
        }
        </style>

    </head>
    <body>
        <h1>Graphing logs</h1>
        
        <p>RabbitMQ connected to app: <strong>{{ connected }}</strong></p>
        
        <p>JSON log entries are sent to the client over WebSocket.</p>

        <p>To send a new JSON log entry, publish it to the AMQP exchange
        &ldquo;tornado&rdquo; using the routing key of
        &ldquo;tornado.*&rdquo;</p>
        
        <h2>Visualization of the log data.</h2>
        <ul>
        </ul>
        <article>
            <p>
            </p>
            <script type="text/javascript" src="static/size_bars.js">
            </script>
            <script type="text/javascript">
            init_draw();
            </script>
            <!-- Here perform the plot -->
        </article>

    </body>
</html>